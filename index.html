<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Scarlett VR Lobby v3.2 (No Anim Test) — A-Frame CDN</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <script src="./js/diagnostics.js"></script>
  <script src="./js/android_joystick.js"></script>
  <script src="./js/collisions.js"></script>
  <script src="./js/bot_controller.js"></script>
  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; background:#000; overflow:hidden; }
    #diag{position:fixed;top:8px;left:8px;z-index:150;pointer-events:none;padding:8px 10px;border-radius:10px;
      font:12px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:rgba(0,0,0,.65);color:#fff;
      max-width:min(92vw,620px);white-space:pre;pointer-events:none;}
    #joyWrap{position:fixed;left:12px;bottom:12px;width:140px;height:140px;z-index:99998;touch-action:none;display:none;}
    #joyBase{position:absolute;inset:0;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.18);
      box-shadow:0 6px 20px rgba(0,0,0,.35) inset;}
    #joyKnob{position:absolute;width:64px;height:64px;left:38px;top:38px;border-radius:999px;background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.25);box-shadow:0 10px 24px rgba(0,0,0,.45);transform:translate(0,0);}
    #helpBar{position:fixed;right:10px;bottom:10px;z-index:200;padding:8px 10px;border-radius:10px;
      font:12px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:rgba(0,0,0,.55);color:#fff;
      max-width:min(56vw,520px); pointer-events:none; }
    #helpBar b{font-weight:700;}
  
    /* Make sure A-Frame Enter VR button is never blocked by HUD */
    .a-enter-vr-button, .a-enter-ar-button {
      z-index: 999999 !important;
      pointer-events: auto !important;
    }
    /* If mobile browser places VR button bottom-right, keep that clear */
    .a-enter-vr-button { right: 10px !important; bottom: 10px !important; }
    </style>
</head>
<body>
  <div id="diag">BOOT…</div>
  <div id="joyWrap" aria-label="Joystick"><div id="joyBase"></div><div id="joyKnob"></div></div>
  <div id="helpBar">
    <b>NO-ANIMATION TEST</b><br/>
    This build forces avatars to be fully static (no clips).<br/>
    Android: joystick (left). VR: thumbstick. (Walk 1.15 / Run 2.15)
  </div>

  <a-scene renderer="antialias:true; colorManagement:true"
           vr-mode-ui="enabled:true"
           diagnostics-overlay>
    <a-assets timeout="120000">
      <a-asset-item id="avatarGLB" src="./assets/avatars/Meshy_Merged_Animations.glb"></a-asset-item>
    </a-assets>

    <a-entity light="type:ambient; intensity:0.45"></a-entity>
    <a-entity light="type:directional; intensity:0.9" position="2 6 3"></a-entity>

    <a-entity id="rig" position="0 0 3"
              android-joystick-move="speed:1.15; runSpeed:2.15"
              world-collisions="enabled:true; playerRadius:0.35; tableRadius:2.45; roomHalfSize:11.4">
      <a-entity id="camera" camera position="0 1.65 0"
                look-controls="pointerLockEnabled:false; touchEnabled:true"></a-entity>
      <a-entity id="leftHand" laser-controls="hand:left" raycaster="objects:.grabbable,.zone,.collidable"></a-entity>
      <a-entity id="rightHand" laser-controls="hand:right" raycaster="objects:.grabbable,.zone,.collidable"></a-entity>
    </a-entity>

    <a-plane class="collidable" rotation="-90 0 0" width="30" height="30" color="#1a1a1a"></a-plane>

    <a-box class="collidable" position="0 1 -12" width="30" height="3" depth="0.4" color="#101010"></a-box>
    <a-box class="collidable" position="0 1 12"  width="30" height="3" depth="0.4" color="#101010"></a-box>
    <a-box class="collidable" position="-12 1 0" width="0.4" height="3" depth="30" color="#101010"></a-box>
    <a-box class="collidable" position="12 1 0"  width="0.4" height="3" depth="30" color="#101010"></a-box>

    <a-entity id="tableRoot">
      <a-cylinder class="collidable" position="0 0.86 0" radius="2.15" height="0.18" color="#0f6b3a"></a-cylinder>
      <a-cylinder class="collidable" position="0 0.42 0" radius="0.65" height="0.84" color="#2c2c2c"></a-cylinder>
      <a-torus class="collidable" position="0 0.95 0" radius="2.15" radius-tubular="0.12" rotation="90 0 0" color="#3a2a1f"></a-torus>
    </a-entity>

    <a-entity id="chairs">
      <a-box class="collidable chair" position="0 0.45 -2.65" width="0.7" height="0.9" depth="0.7" color="#444"><a-entity class="seatAnchor" position="0 0.55 0.2"></a-entity></a-box>
      <a-box class="collidable chair" position="2.3 0.45 -1.4" width="0.7" height="0.9" depth="0.7" color="#444"><a-entity class="seatAnchor" position="0 0.55 0.2"></a-entity></a-box>
      <a-box class="collidable chair" position="-2.3 0.45 -1.4" width="0.7" height="0.9" depth="0.7" color="#444"><a-entity class="seatAnchor" position="0 0.55 0.2"></a-entity></a-box>
      <a-box class="collidable chair" position="2.3 0.45 1.4" width="0.7" height="0.9" depth="0.7" color="#444"><a-entity class="seatAnchor" position="0 0.55 -0.2"></a-entity></a-box>
      <a-box class="collidable chair" position="-2.3 0.45 1.4" width="0.7" height="0.9" depth="0.7" color="#444"><a-entity class="seatAnchor" position="0 0.55 -0.2"></a-entity></a-box>
      <a-box class="collidable chair" position="0 0.45 2.65" width="0.7" height="0.9" depth="0.7" color="#444"><a-entity class="seatAnchor" position="0 0.55 -0.2"></a-entity></a-box>
    </a-entity>

    <!-- Bot 1: walker (moves, but avatar mesh is static) -->
    <a-entity id="botWalker" position="5 0 0" bot-walker="speed:0.85; radius:0.45">
      <a-entity gltf-model="#avatarGLB" no-anim="label:botWalker"></a-entity>
    </a-entity>

    <!-- Bot 2: seated (static) -->
    <a-entity id="botSeated" position="0 0 -2.65" bot-seated="chairSelector:.chair">
      <a-entity gltf-model="#avatarGLB" no-anim="label:botSeated"></a-entity>
    </a-entity>

    <a-sky color="#050505"></a-sky>
  </a-scene>
</body>
</html>
