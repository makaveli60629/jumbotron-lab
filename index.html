<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>ScarlettVR Test Server Spine</title>
  <style>
    html,body{margin:0;padding:0;background:#000;overflow:hidden;font-family:monospace;touch-action:none}
    #app{position:fixed;inset:0}
    #hud{
      position:fixed;top:12px;left:12px;z-index:9999;
      width:330px;max-width:calc(100vw - 24px);
      background:rgba(10,16,32,.86);border:1px solid #00ffff;
      color:#00ffff;padding:12px;border-radius:12px;
      box-shadow:0 10px 30px rgba(0,0,0,.5);
    }
    #hud h2{margin:0 0 8px 0;font-size:14px}
    #hud small{color:#9ff;opacity:.9}
    #hud .row{display:flex;gap:8px;margin-top:8px}
    #hud input{flex:1;background:#000;border:1px solid #225;color:#0f0;padding:8px;border-radius:8px;font-family:monospace}
    #hud button{
      width:100%;margin-top:8px;padding:10px;
      background:#00ffff;color:#000;border:none;border-radius:10px;
      font-weight:800;cursor:pointer;
    }
    #hud button.secondary{background:#102030;color:#00ffff;border:1px solid #00ffff}
    #hudlog{
      height:120px;overflow:auto;background:#000;margin-top:8px;
      border:1px solid #234;border-radius:8px;padding:6px;
      color:#00ff00;font-size:10px;white-space:pre-wrap;
    }
    /* Android controls overlay */
    #touchLayer{position:fixed;inset:0;z-index:50;pointer-events:none}
    .joy{
      position:absolute;bottom:18px;left:18px;width:140px;height:140px;
      border-radius:50%;border:2px solid rgba(0,255,255,.35);
      background:rgba(0,0,0,.15);display:none;
    }
    .knob{
      position:absolute;left:50%;top:50%;width:54px;height:54px;
      transform:translate(-50%,-50%);
      border-radius:50%;
      border:2px solid rgba(0,255,255,.75);
      background:rgba(0,255,255,.10);
    }
    .lookHint{
      position:absolute;bottom:26px;right:18px;
      padding:8px 10px;border-radius:10px;
      border:1px solid rgba(0,255,255,.35);
      color:#00ffff;background:rgba(0,0,0,.25);
      display:none;
    }
  </style>

  <!-- Use importmap so 'three' + addons resolve consistently on all browsers -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
    }
  }
  </script>
</head>
<body>
  <div id="app"></div>

  <div id="hud">
    <h2>SCARLETT TEST SERVER — PERMANENT SPINE</h2>
    <small>
      Desktop: WASD + Mouse (click/drag) • Android: Left Joystick + Right Drag Look • Quest: Enter VR
    </small>

    <div class="row">
      <div style="flex:1">
        <div id="statline">BOOTING…</div>
      </div>
    </div>

    <div class="row">
      <input id="avatarUrl" placeholder="Optional GLB/GLTF URL (https://...)" />
    </div>

    <button id="btnLoadAvatar">LOAD AVATAR (URL or /assets/avatar.glb)</button>
    <button id="btnReloadModules" class="secondary">RELOAD MODULES</button>
    <button id="btnHideHud">PLAY (HIDE HUD)</button>

    <div id="hudlog">INITIALIZING…</div>
  </div>

  <!-- Touch controls layer (visual only; events handled in core/android_controls.js) -->
  <div id="touchLayer">
    <div class="joy" id="joyBase"><div class="knob" id="joyKnob"></div></div>
    <div class="lookHint" id="lookHint">Look: drag right side</div>
  </div>

  <script type="module" src="./index.js"></script>
</body>
</html>
